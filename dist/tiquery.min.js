/*
 * TiQuery Javascript Library for Titanium v0.0.1
 *
 * Copyright 2010 Eric Faerber, Natural Code Project
 * Released under GPL Version 2
 *
 * Includes large portions of jQuery
 * http://jquery.com
 * Copyright 2010, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */
(function(l,d){var f=function(n){return new f.fn.init(n)},e=l.TiQuery,h=l.$,m=/\S/,g=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,b=Object.prototype.toString,c=Object.prototype.hasOwnProperty,i=Array.prototype.push,k=Array.prototype.slice,j=Array.prototype.indexOf;f.fn={init:function(n,o){if(!n){return this}this.context=this[0]=n;this.length=1;return this},size:function(){return this.length},toArray:function(){return k.call(this,0)},get:function(n){return n==null?this.toArray():(n<0?this.slice(n)[0]:this[n])},pushStack:function(o,q,n){var p=f();if(TiQueryuery.isArray(o)){i.apply(p,o)}else{f.merge(p,o)}p.prevObject=this;p.context=this.context;if(q==="find"){p.selector=this.selector+(this.selector?" ":"")+n}else{if(q){p.selector=this.selector+"."+q+"("+n+")"}}return p},each:function(o,n){return f.fn.each(this,o,n)},ready:function(n){return this},eq:function(n){return n===-1?this.slice(n):this.slice(n,+n+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(k.apply(this,arguments),"slice",k.call(arguments).join(","))},map:function(n){return this.pushStack(f.fn.map(this,function(p,o){return n.call(p,o,p)}))},end:function(){return this.prevObject||f(null)},push:i,sort:[].sort,splice:[].splice};f.fn.init.prototype=f.fn;f.extend=f.fn.extend=function(){var s=arguments[0]||{},r=1,q=arguments.length,u=false,v,p,n,o;if(typeof s==="boolean"){u=s;s=arguments[1]||{};r=2}if(typeof s!=="object"&&!f.fn.isFunction(s)){s={}}if(q===r){s=this;--r}for(;r<q;r++){if((v=arguments[r])!=null){for(p in v){n=s[p];o=v[p];if(s===o){continue}if(u&&o&&(f.fn.isPlainObject(o)||f.fn.isArray(o))){var t=n&&(f.fn.isPlainObject(n)||f.fn.isArray(n))?n:f.fn.isArray(o)?[]:{};s[p]=f.fn.extend(u,t,o)}else{if(o!==d){s[p]=o}}}}}return s};f.fn.extend({noConflict:function(n){l.$=h;if(n){l.TiQuery=e}return f},isFunction:function(n){return b.call(n)==="[object Function]"},isArray:function(n){return b.call(n)==="[object Array]"},isPlainObject:function(o){if(!o||b.call(o)!=="[object Object]"||o.nodeType||o.setInterval){return false}if(o.constructor&&!c.call(o,"constructor")&&!c.call(o.constructor.prototype,"isPrototypeOf")){return false}var n;for(n in o){}return n===d||c.call(o,n)},isEmptyObject:function(o){for(var n in o){return false}return true},error:function(n){throw n},parseJSON:function(n){if(typeof n!=="string"||!n){return null}n=f.fn.trim(n);if(/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return JSON.parse(n)}else{f.fn.error("Invalid JSON: "+n)}},noop:function(){},each:function(q,u,p){var o,r=0,s=q.length,n=s===d||f.fn.isFunction(q);if(p){if(n){for(o in q){if(u.apply(q[o],p)===false){break}}}else{for(;r<s;){if(u.apply(q[r++],p)===false){break}}}}else{if(n){for(o in q){if(u.call(q[o],o,q[o])===false){break}}}else{for(var t=q[0];r<s&&u.call(t,r,t)!==false;t=q[++r]){}}}return q},trim:function(n){return(n||"").replace(g,"")},makeArray:function(p,o){var n=o||[];if(p!=null){if(p.length==null||typeof p==="string"||f.fn.isFunction(p)||(typeof p!=="function"&&p.setInterval)){i.call(n,p)}else{f.fn.merge(n,p)}}return n},inArray:function(p,q){if(q.indexOf){return q.indexOf(p)}for(var n=0,o=q.length;n<o;n++){if(q[n]===p){return n}}return -1},merge:function(r,p){var q=r.length,o=0;if(typeof p.length==="number"){for(var n=p.length;o<n;o++){r[q++]=p[o]}}else{while(p[o]!==d){r[q++]=p[o++]}}r.length=q;return r},grep:function(o,s,n){var p=[];for(var q=0,r=o.length;q<r;q++){if(!n!==!s(o[q],q)){p.push(o[q])}}return p},map:function(o,t,n){var p=[],s;for(var q=0,r=o.length;q<r;q++){s=t(o[q],q,n);if(s!=null){p[p.length]=s}}return p.concat.apply([],p)},clone:function(p,n){var o={};if(n==true){f.fn.extend(true,p,o)}else{f.fn.extend(p,o)}return o},guid:1,proxy:function(p,o,n){if(arguments.length===2){if(typeof o==="string"){n=p;p=n[o];o=d}else{if(o&&!f.fn.isFunction(o)){n=o;o=d}}}if(!o&&p){o=function(){return p.apply(n||this,arguments)}}if(p){o.guid=p.guid=p.guid||o.guid||f.fn.guid++}return o}});function a(){return(new Date).getTime()}f.fn.extend({bind:function(o,n){this[0].addEventListener(o,n);return this},unbind:function(n){this[0].removeEventListener(n);return this},trigger:function(n){this[0].fireEvent(n);return this},click:function(n){if(n==null){this.trigger("click")}else{this.bind("click",n)}return this},dblclick:function(n){if(n==null){this.trigger("dblclick")}else{this.bind("dblclick",n)}return this},doubletap:function(n){if(n==null){this.trigger("doubletap")}else{this.bind("doubletap",n)}return this},singletap:function(n){if(n==null){this.trigger("singletap")}else{this.bind("singletap",n)}return this},swipe:function(n){if(n==null){this.trigger("swipe")}else{this.bind("swipe",n)}return this},touchcancel:function(n){if(n==null){this.trigger("touchcancel")}else{this.bind("touchcancel",n)}return this},touchend:function(n){if(n==null){this.trigger("touchend")}else{this.bind("touchend",n)}return this},touchmove:function(n){if(n==null){this.trigger("touchmove")}else{this.bind("touchmove",n)}return this},touchstart:function(n){if(n==null){this.trigger("touchstart")}else{this.bind("touchstart",n)}return this},twofingertap:function(n){if(n==null){this.trigger("twofingertap")}else{this.bind("twofingertap",n)}return this},scroll:function(n){if(n==null){this.trigger("scroll")}else{this.bind("scroll",n)}return this},cancel:function(n){if(n==null){this.trigger("cancel")}else{this.bind("cancel",n)}return this},orientationchange:function(n){if(n==null){this.trigger("orientationchange")}else{this.bind("orientationchange",n)}return this},shake:function(n){if(n==null){this.trigger("shake")}else{this.bind("shake",n)}return this}});f.fn.extend({xhrSettings:{type:"get",dataType:"",onError:null,onLoad:null,onDataStream:null,onReadyStateChange:null,onSendStream:null},xhr:function(n){var o=f.extend(true,{},f.fn.xhrSettings,n);if(o.url==null){return false}o.type=o.type.toUpperCase();o.dataType=o.dataType.toUpperCase();var p=l.Network.createHTTPClient();p.ondatastream=o.onDataStream;p.onsendstream=o.onSendStream;p.onreadystatechange=o.onReadyStateChange;p.onload=function(r){l.API.info("XHR completed");var q=false;if(o.dataType=="XML"){try{q=this.responseXML}catch(s){l.API.error(s);q=false}}else{if(o.dataType=="JSON"){q=f.fn.parseJSON(this.responseText)}else{q=this.responseText}}if(f.fn.isFunction(o.onLoad)){o.onLoad(q,p,r)}};p.onerror=function(q){l.API.error("XHR error: "+q.error);if(f.fn.isFunction(o.onError)){o.onError(p,q)}};p.open(o.type,o.url);p.send(o.data);p=null},get:function(n,p,o){if(f.fn.isFunction(p)){o=p;p={}}this.xhr({type:"get",url:n,data:p,onLoad:o})},getJSON:function(n,p,o){if(f.fn.isFunction(p)){o=p;p={}}this.xhr({type:"get",dataType:"JSON",url:n,data:p,onLoad:o})},getXML:function(n,p,o){if(f.fn.isFunction(p)){o=p;p={}}this.xhr({type:"get",dataType:"XML",url:n,data:p,onLoad:o})},post:function(n,p,o){if(f.fn.isFunction(p)){o=p;p={}}this.xhr({type:"post",url:n,data:p,onLoad:o})},postJSON:function(n,p,o){if(f.fn.isFunction(p)){o=p;p={}}this.xhr({type:"post",dataType:"JSON",url:n,data:p,onLoad:o})},postXML:function(n,p,o){if(f.fn.isFunction(p)){o=p;p={}}this.xhr({type:"post",dataType:"XML",url:n,data:p,onLoad:o})}});l.TiQuery=l.$=f})(Titanium);var TiQuery=$=Titanium.TiQuery;